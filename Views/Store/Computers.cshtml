@using PerfectSite.Data.Products
@using PerfectSite.ViewModels.PageSortFilter
@using PerfectSite.ViewModels.Store.Computers
@model ProductViewModel<Computer>
@{
    Layout = "_Layout";
    ViewData["Title"] = "Computers";
}
<html>
    <body>
        <h1>Список товаров</h1>
<form method = "get">
     <div class="form-inline">
         <label>Название</label>
         <input name = "name" value="@Model.FilterViewModel.SelectedName" class = "form-control  my-text my-border-color my-textbar-background" />
         <label>Компания </label>
        <select name="manufacturer" asp-items="Model.FilterViewModel.Manufacturers" class="form-control my-text my-border-color my-textbar-background" ></select>
 
        <input type="submit" value="Фильтр" class="btn btn-primary my-btn" />
     </div>
</form>

<table class="table" >
    <tr>
        <th>
            
            <a asp-action = "Computers" asp-route-sortOrder="@(Model.SortingViewModel.NameSort)"
               asp-route-name="@(Model.FilterViewModel.SelectedName)"
               asp-route-manufacturer="@(Model.FilterViewModel.SelectedManufacturer)">Название</a>
        </th>
        <th>
            <a asp-action="Computers" asp-route-sortOrder="@(Model.SortingViewModel.PriceSort)"
               asp-route-name="@(Model.FilterViewModel.SelectedName)"
               asp-route-manufacturer="@(Model.FilterViewModel.SelectedManufacturer)">Цена</a>
        </th>
        <th>
             <a asp-action="Computers" asp-route-sortOrder="@(Model.SortingViewModel.AmountSort)"
               asp-route-name="@(Model.FilterViewModel.SelectedName)"
               asp-route-manufacturer="@(Model.FilterViewModel.SelectedManufacturer)">Осталось на складе</a>
        </th>
        <th>
             <a asp-action="Computers" asp-route-sortOrder="@(Model.SortingViewModel.PopularitySort)"
               asp-route-name="@(Model.FilterViewModel.SelectedName)"
               asp-route-manufacturer="@(Model.FilterViewModel.SelectedManufacturer)">Популярность</a>
        </th>

    </tr>
        @foreach(var product in Model.Products)
        {
            <tr>
                <td class = "my-text ">
                     <a asp-controller="ProductPage" asp-action="ComputerPage" asp-route-id = "@product.Id">@product.ModelName</a>
                </td>
                <td  class = "my-text ">
                    Бесценен
                </td>
                <td  class = "my-text ">
                    @product.Amount
                </td>
                <td class = "my-text">Наивысшая</td>
                @{
                   
                    if(User.IsInRole("God of the Site"))
                    {
                        <td>
                            <a asp-action="CPU_Details" asp-controller="Data" asp-route-id="@product.Id">Подробнее</a> |
                            <a asp-action="CPU_Edit" asp-controller="Data" asp-route-id="@product.Id">Изменить</a> |
                            <a asp-action="CPU_Delete" asp-controller="Data" asp-route-id="@product.Id">Удалить</a>
                        </td>
                    }
                }
                
            </tr>
        }
    </table>

    @if (Model.PageViewModel.HasPreviousPage)
    {
         <a asp-action="Computers"
       asp-route-page="@(Model.PageViewModel.PageNumber - 1)"
       asp-route-name="@(Model.FilterViewModel.SelectedName)"
       asp-route-manufacturer="@(Model.FilterViewModel.SelectedManufacturer)"
       asp-route-sortorder="@(Model.SortingViewModel.Current)"
       class="btn btn-primary">Назад </a>
    }
    @if (Model.PageViewModel.HasNextPage)
{
    <a asp-action="Computers"
       asp-route-page="@(Model.PageViewModel.PageNumber + 1)"
       asp-route-name="@(Model.FilterViewModel.SelectedName)"
       asp-route-manufacturer="@(Model.FilterViewModel.SelectedManufacturer)"
       asp-route-sortorder="@(Model.SortingViewModel.Current)"
       class="btn btn-primary">
        Вперед
    </a>
}
</body>
</html>

